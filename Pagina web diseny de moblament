<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Noa - Simulador de Diseño</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f9;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #4a4a8a;
      color: white;
      padding: 20px;
      text-align: center;
    }

    .simulador {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px;
    }

    .habitacion {
      width: 800px;
      height: 500px;
      background-color: #e0e0e0;
      border: 2px dashed #999;
      position: relative;
      margin-bottom: 20px;
    }

    .mueble {
      width: 80px;
      height: 80px;
      position: absolute;
      cursor: move;
    }

    .mueble svg {
      width: 100%;
      height: 100%;
    }

    .botones {
      margin-bottom: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .botones button {
      padding: 10px 15px;
      background-color: #4a4a8a;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .botones button:hover {
      background-color: #35356b;
    }
  </style>
</head>
<body>

  <header>
    <h1>Diseña el interior de tu casa</h1>
    <p>Añade y organiza muebles en tu espacio personalizado</p>
  </header>

  <div class="simulador">
    <div class="botones">
      <button onclick="agregarMueble('Cama')">Añadir Cama</button>
      <button onclick="agregarMueble('Sofá')">Añadir Sofá</button>
      <button onclick="agregarMueble('Mesa')">Añadir Mesa</button>
      <button onclick="agregarMueble('Silla')">Añadir Silla</button>
      <button onclick="agregarMueble('Lámpara')">Añadir Lámpara</button>
      <button onclick="agregarMueble('Estantería')">Añadir Estantería</button>
      <button onclick="agregarMueble('TV')">Añadir TV</button>
      <button onclick="agregarMueble('Escritorio')">Añadir Escritorio</button>
      <button onclick="agregarMueble('Alfombra')">Añadir Alfombra</button>
      <button onclick="agregarMueble('Planta')">Añadir Planta</button>
    </div>

    <div class="habitacion" id="habitacion"></div>

    <div class="botones">
      <button onclick="guardarPosiciones()">Guardar Diseño</button>
      <button onclick="cargarPosiciones()">Cargar Diseño</button>
      <button onclick="descargarImagen()">Descargar Imagen</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    const habitacion = document.getElementById('habitacion');
    let idMueble = 0;

    function agregarMueble(nombre) {
      const mueble = document.createElement('div');
      mueble.className = 'mueble';
      mueble.draggable = true;
      mueble.id = `mueble-${idMueble++}`;
      mueble.style.top = '10px';
      mueble.style.left = '10px';
      mueble.innerHTML = getSVG(nombre);
      mueble.setAttribute('data-nombre', nombre);
      mueble.addEventListener('dragstart', dragStart);
      habitacion.appendChild(mueble);
    }

    function dragStart(e) {
      e.dataTransfer.setData("text/plain", e.target.id);
    }

    habitacion.addEventListener('dragover', e => e.preventDefault());

    habitacion.addEventListener('drop', e => {
      e.preventDefault();
      const id = e.dataTransfer.getData("text");
      const mueble = document.getElementById(id);
      const rect = habitacion.getBoundingClientRect();
      mueble.style.left = (e.clientX - rect.left - 40) + 'px';
      mueble.style.top = (e.clientY - rect.top - 40) + 'px';
    });

    function guardarPosiciones() {
      const datos = [];
      document.querySelectorAll('.mueble').forEach(mueble => {
        datos.push({
          id: mueble.id,
          nombre: mueble.getAttribute('data-nombre'),
          top: mueble.style.top,
          left: mueble.style.left
        });
      });
      localStorage.setItem('disenoNoa', JSON.stringify(datos));
      alert('Diseño guardado.');
    }

    function cargarPosiciones() {
      const datos = JSON.parse(localStorage.getItem('disenoNoa') || '[]');
      habitacion.innerHTML = '';
      datos.forEach(info => {
        const mueble = document.createElement('div');
        mueble.className = 'mueble';
        mueble.id = info.id;
        mueble.style.top = info.top;
        mueble.style.left = info.left;
        mueble.draggable = true;
        mueble.setAttribute('data-nombre', info.nombre);
        mueble.innerHTML = getSVG(info.nombre);
        mueble.addEventListener('dragstart', dragStart);
        habitacion.appendChild(mueble);
      });
      alert('Diseño cargado.');
    }

    function descargarImagen() {
      html2canvas(habitacion).then(canvas => {
        const link = document.createElement('a');
        link.download = 'diseno_noa.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    function getSVG(nombre) {
      switch (nombre) {
        case 'Cama':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect width="100" height="60" fill="#8d6e63"/>
            <rect x="5" y="10" width="40" height="20" fill="#efebe9"/>
            <rect x="55" y="10" width="40" height="20" fill="#efebe9"/>
          </svg>`;
        case 'Sofá':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect y="20" width="100" height="30" fill="#6d4c41"/>
            <rect x="10" y="10" width="20" height="20" fill="#a1887f"/>
            <rect x="70" y="10" width="20" height="20" fill="#a1887f"/>
          </svg>`;
        case 'Mesa':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect x="10" y="20" width="80" height="20" fill="#bcaaa4"/>
          </svg>`;
        case 'Silla':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect x="30" y="10" width="40" height="10" fill="#a1887f"/>
            <rect x="35" y="20" width="30" height="30" fill="#8d6e63"/>
          </svg>`;
        case 'Lámpara':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <line x1="50" y1="0" x2="50" y2="20" stroke="#616161" stroke-width="4"/>
            <circle cx="50" cy="35" r="15" fill="#fff176" />
          </svg>`;
        case 'Estantería':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect width="100" height="60" fill="#6d4c41"/>
            <line x1="0" y1="20" x2="100" y2="20" stroke="#fff" stroke-width="2"/>
            <line x1="0" y1="40" x2="100" y2="40" stroke="#fff" stroke-width="2"/>
          </svg>`;
        case 'TV':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect x="10" y="10" width="80" height="40" fill="#212121"/>
            <rect x="20" y="20" width="60" height="20" fill="#424242"/>
          </svg>`;
        case 'Escritorio':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect x="5" y="20" width="90" height="20" fill="#a1887f"/>
            <rect x="10" y="40" width="10" height="15" fill="#6d4c41"/>
            <rect x="80" y="40" width="10" height="15" fill="#6d4c41"/>
          </svg>`;
        case 'Alfombra':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect x="10" y="10" width="80" height="40" fill="#fdd835"/>
            <rect x="30" y="20" width="40" height="20" fill="#fbc02d"/>
          </svg>`;
        case 'Planta':
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <circle cx="50" cy="20" r="10" fill="green"/>
            <rect x="45" y="30" width="10" height="20" fill="#795548"/>
          </svg>`;
        default:
          return `<svg viewBox="0 0 100 60" xmlns="http://www.w3.org/2000/svg">
            <rect x="10" y="10" width="80" height="40" fill="#ccc"/>
            <text x="50" y="35" font-size="12" fill="#000" text-anchor="middle" alignment-baseline="middle">${nombre}</text>
          </svg>`;
      }
    }
  </script>
</body>
</html>


